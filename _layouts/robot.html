---
layout: default
endpoint: team/frc3461/events
---
<!-- <script src="/assets/js/tba.js"></script> -->
<meta property="og:title" content="Operation PEACCE Robotics - {{ page.title }} {{ page.robot }}" />
<meta property="og:description" content="{{ page.game }} performace and statistics"/>
<div class="container-fluid">
    <br>
    <flex style="flex-flow: row wrap;">
        <div class="container float-left" style="width: 400px; height: 30rem;">
            <div id="demo" class="carousel slide" data-ride="carousel" style="width:100%; height: 100%; background-color: white; border-radius: 5px;">
                <!-- The slideshow -->
                <!-- <div id="robotImagePlaceholder" class="carousel-item img-thumbnail" style="width: 400px; height:400px; background-size: 100% auto; background-repeat: no-repeat; background: center center; background-image:url('/assets/images/notFound.png');"></div> -->
                <img src="/assets/images/notFound.png" id="robotImagePlaceholder" class="carousel-item img-thumbnail" style="width:100%; height:100%; object-fit: cover;"></img>
                <!-- </div> -->
                <div class="carousel-inner" id="robotCarousel">
                </div>
            </div> 
        </div>
        <div>
            <h1>{{ page.title }} - {{page.robot}}</h1>
            <h2>{{ page.game }}</h2>
            <h3 id="districtPoints">District Points Earned: --</h3>
            <h3 id="districtRank">District Rank: --</h3>
            {{ content }}
        </div>
    </flex>
    <br>

    <div class="table-responsive">
        <table id="employees" class="table"></table>
    </div> 

</div>

<script>
var events = "https://www.thebluealliance.com/api/v3/team/frc3461/events/";
var year = "{{ page.title }}"
var eventstatuses = "/statuses?X-TBA-Auth-Key=hOngAA1OYRpYtrfePLodT2G27R7fSBfrGJ57RwH1sOZJxaJv3rHGfhH37aLitVNb"
const authKey = "?X-TBA-Auth-Key=hOngAA1OYRpYtrfePLodT2G27R7fSBfrGJ57RwH1sOZJxaJv3rHGfhH37aLitVNb"
var district = "https://www.thebluealliance.com/api/v3/district/{{ page.title }}ne/rankings"+authKey
var media = "https://www.thebluealliance.com/api/v3/team/frc3461/media/"
var awards = "https://www.thebluealliance.com/api/v3/team/frc3461/awards/"


var eventstats = events + year + eventstatuses;
var eventurl = events + year + authKey;
var mediaurl = media + year + authKey;
var awardsurl = awards + year + authKey;
var countDownDate;

function json2array(json) {
var result = [];
for (var i in json) {
    result.push([i, json[i]]);
}
return result;
}
// Defining async function


async function getMedia(mediaURL) {
const apiResponse = await fetch(mediaURL);
const mediaJSON = await apiResponse.json();
//console.log(mediaJSON);
var hasPlacedImage = false;
if (mediaJSON.length != 0)
for (var i = 0; i < mediaJSON.length; i++) {
    const tempMedia = mediaJSON[i];
    //console.log(mediaJSON[i]);
    if (mediaJSON[i].preferred == true && mediaJSON[i].direct_url != undefined) {

    if (hasPlacedImage == false) {
        document.getElementById("robotCarousel").innerHTML += `<img src="${mediaJSON[i].direct_url}" class="carousel-item active img-thumbnail" style="width:100%; height:30rem; object-fit: cover;"></img>`;
        hasPlacedImage = true;
    } else {
        document.getElementById("robotCarousel").innerHTML += `<img src="${mediaJSON[i].direct_url}" class="carousel-item img-thumbnail" style="width:100%; height:30rem; object-fit: cover;"></img>`;
    }


    }
}

if (mediaJSON.length == 0 || hasPlacedImage == false) {
    document.getElementById("robotImagePlaceholder").classList.add("active");
}

}

async function getapi(eventurl, eventstats, awards) {
    const eventResponse = await fetch(eventurl);
    const eventStats = await fetch(eventstats);
    const awardsData = await fetch(awards);
    // Storing data in form of JSON
    var eventdata = await eventResponse.json();
    // var eventdata = JSON.parse(eventdatatemp);
    var eventstatdata = await eventStats.json();
    var awardsForYear = await awardsData.json();
    /* console.log("Event Data")
    console.log(eventdata);
    console.log("Event Stats")
    console.log(eventstatdata); */


    show(eventstatdata, eventdata, awardsForYear);

    getMedia(mediaurl);
    }
    // Calling that async function
    getapi(eventurl, eventstats, awardsurl);

    getDistrictStats(district);

    async function getDistrictStats(district) {
    var districtResponse = await fetch(district);
    var districtJSON = await districtResponse.json();
    var teamDistrictRankings;
    
    for (var i = 0; i < districtJSON.length; i++) {
                if (districtJSON[i].team_key == "frc3461") {
        console.log(districtJSON[i]);
        document.getElementById("districtRank").innerHTML = "District Rank: " + districtJSON[i].rank; 
        document.getElementById("districtPoints").innerHTML = "District Points Earned: " + districtJSON[i].point_total; 
    }
    }

    }


    // Function to define innerHTML for HTML table
    function show(event, stats, awards) {
    /*       console.log("event info");
            console.log(event);
            console.log("match info");
            console.log(stats); */
    let tab =
        `<tr>
        <th>Event Name</th>
        <th>Ranking</th>
        <th>Awards</th>
    </tr>`;

    var result = json2array(event);
    var statResult = json2array(stats);

    length = result.length;
    //console.log(result);
    labels = [];
    values = [];
    for (i = 0; i < length; i++) {
        labels.push(result[i]);
    }

    if (length == 0) {
        tab = `<h1 class=text-center>No Events Found</h1>`
        document.getElementById("employees").innerHTML = tab;
    }

    //console.log(labels);
    //console.log(awards)
    for (var label in labels) {
        if (labels[label][1] != null) {
            if (stats[label].event_type_string == "Offseason") {
                tab += `<tr><td date=${stats[label].start_date} id=${stats[label].key}>${stats[label].name} (Offseason Event)</td><td>${labels[label][1].overall_status_str}</td><td id=${stats[label].key + "awards"}>None Found</td></tr>`;
            } else {
        tab += `<tr><td date=${stats[label].start_date} id=${stats[label].key}>${stats[label].name}</td><td>${labels[label][1].overall_status_str}</td><td id=${stats[label].key + "awards"}>None Found</td></tr>`;
            }
        } else {
        tab += `<tr><td date=${stats[label].start_date} id=${stats[label].key}>${stats[label].name}</td><td>No Data</td><td>No Data</td></tr>`
        }
        // Setting innerHTML as tab variable
        document.getElementById("employees").innerHTML = tab;
        sortTable();
    }

    //console.log(awards);
    for (var i = 0; i < awards.length; i++) {
        //console.log(awards[i]);
        document.getElementById(awards[i].event_key + "awards").innerHTML = awards[i].name;
    }

    }

    function sortTable() {
      var table, rows, switching, i, x, y, shouldSwitch;
      table = document.getElementById("employees");
      switching = true;
      /* Make a loop that will continue until
      no switching has been done: */
      while (switching) {
        // Start by saying: no switching is done:
        switching = false;
        rows = table.rows;
        /* Loop through all table rows (except the
        first, which contains table headers): */
        for (i = 1; i < (rows.length - 1); i++) {
          // Start by saying there should be no switching:
          shouldSwitch = false;
          /* Get the two elements you want to compare,
          one from current row and one from the next: */
          x = rows[i].getElementsByTagName("TD")[0];
          y = rows[i + 1].getElementsByTagName("TD")[0];
          xTime = Date.parse(x.getAttribute("date"));
          yTime = Date.parse(y.getAttribute("date"));
          // Check if the two rows should switch place:
          if (xTime > yTime) {
            // If so, mark as a switch and break the loop:
            shouldSwitch = true;
            break;
          }
        }
        if (shouldSwitch) {
          /* If a switch has been marked, make the switch
          and mark that a switch has been done: */
          rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
          switching = true;
        }
      }
    }
</script>