---
layout: admin
title: Dashboard
---
<div>
    <div id="dataInput">
    <div class="form-group">
      <label for="title">Filename</label>
      <textarea class="form-control" rows="1" id="title"></textarea>
    </div>
    <div class="form-group">
      <label for="content">Content</label>
      <textarea class="form-control" style="white-space: pre-wrap;" rows="25" id="content"></textarea>
    </div>
    </div>
    <button onclick="generatePostFile()" class="btn btn-primary">Download</button>
    <button onclick="uploadToGithub()" type="button" class="btn btn-outline-primary">Upload to Github

    </button>
</div>



<script>

    const queryString = window.location.search;
    // console.log(queryString);
    const urlParams = new URLSearchParams(queryString);
    const post = urlParams.get('post');
    let postContent = ""
    if (post != null) {
    getPost(post);
    } else {
        date = `REPLACEME.md`;
        frontMatter = `---
        ---
<-- Do not edit except for the REPLACE ME items -->`
        document.getElementById('title').innerHTML = date;
        document.getElementById('content').innerHTML = frontMatter;
    }
    async function getPost(post) {
        var postClean = post.replace('/', '-');
        var postRaw = await fetch('https://raw.githubusercontent.com//Operation-P-E-A-C-C-E-Robotics/Operation-P-E-A-C-C-E-Robotics.github.io/main/_data/' + postClean);
        postContent = await postRaw.text();
        // console.log(postRaw);
        // console.log(postContent);

        document.getElementById('title').innerHTML = postClean;
        document.getElementById('content').innerHTML = postContent;
    }

    function generatePostFile() {
        var element = document.createElement(`a`);
        var content = [];
        var filename = document.getElementById('title').value;
        console.log(filename);
        var filecontent = document.getElementById('content').value;
        //console.log(filecontent);
        content.push(filecontent);
        var blob = new Blob([content], { type: `plain/text` });
        var fileUrl = URL.createObjectURL(blob);
        element.setAttribute('href', fileUrl); //file location
        element.setAttribute('download', filename); // file name
        element.style.display ='none';
        document.body.appendChild(element);
        element.click();
        // commitPost(blob);
    }

    function uploadToGithub() {
        window.open("https://github.com/Operation-P-E-A-C-C-E-Robotics/Operation-P-E-A-C-C-E-Robotics.github.io/upload/main/_robots", '_blank');
    }

</script>
<script type="module">
    import { Octokit } from "https://cdn.skypack.dev/@octokit/rest";
    window.commitPost = commitPost;
    async function commitPost(file) {
        // Octokit.js
        // https://github.com/octokit/core.js#readme
        const octokit = new Octokit({
        auth: 'YOUR-TOKEN'
        })

        await octokit.request('POST /repos/{owner}/{repo}/pulls', {
            owner: 'Operation-P-E-A-C-C-E-Robotics',
            repo: 'Operation-P-E-A-C-C-E-Robotics.github.io',
            title: 'Web Backend Changes',
            body: 'Please pull these changes in',
            head: 'Operation-P-E-A-C-C-E-Robotics:main',
            base: 'master',
            headers: {
                'X-GitHub-Api-Version': '2022-11-28'
            }
        })
    }

</script>