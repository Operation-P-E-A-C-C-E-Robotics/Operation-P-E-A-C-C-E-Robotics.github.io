---
layout: admin
title: Dashboard
---
<div>
    <div id="dataInput">
    <div class="form-group">
      <label for="title">Filename</label>
      <textarea class="form-control" rows="1" id="title"></textarea>
    </div>
    <div class="form-group mdEdit">
      <label for="content">Content</label>
      <textarea class="form-control" style="white-space: pre-wrap;" rows="25" id="content"></textarea>
    </div>
    </div>
    <button onclick="generatePostFile()" class="btn btn-primary">Download</button>
    <button onclick="uploadToGithub()" type="button" class="btn btn-outline-primary">Upload to Github

    </button>
</div>

<!-- <div class="mdEdit">
    <div></div>
    <input type="text" value="Initial Value"> 
  </div> -->

<script>

    const queryString = window.location.search;
    // //console.log(queryString);
    const urlParams = new URLSearchParams(queryString);
    const post = urlParams.get('post');
    let postContent = ""
    if (post != null) {
    getPost(post);
    } else {
        date = `${new Date().getFullYear()}.md`;
        frontMatter = `---
layout: robot
year: ${new Date().getFullYear()}
robotName: REPLACE ME
game: REPLACE ME
thumbnail: /assets/images/notFound.png
techBinder: "REPLACE ME"
matchVideoPlaylist: "REPLACE ME"
---
<-- Do not edit anything inside the tripple dashes except for the REPLACE ME items -->

# I am an example header, I will be bigger then normal text and have a heavier font weight
I am an example paragraph, I look like normal text
`
        document.getElementById('title').innerHTML = date;
        document.getElementById('content').innerHTML = frontMatter;
    }
    async function getPost(post) {
        var postClean = post.replace('/', '-');
        var postRaw = await fetch('https://raw.githubusercontent.com//Operation-P-E-A-C-C-E-Robotics/Operation-P-E-A-C-C-E-Robotics.github.io/main/_robots/' + postClean);
        postContent = await postRaw.text();
        // //console.log(postRaw);
        // //console.log(postContent);

        document.getElementById('title').innerHTML = postClean;
        document.getElementById('content').innerHTML = postContent;
    }

    function generatePostFile() {
        var element = document.createElement(`a`);
        var content = [];
        var filename = document.getElementById('title').value;
        //console.log(filename);
        var filecontent = document.getElementById('content').value;
        ////console.log(filecontent);
        content.push(filecontent);
        var blob = new Blob([content], { type: `plain/text` });
        var fileUrl = URL.createObjectURL(blob);
        element.setAttribute('href', fileUrl); //file location
        element.setAttribute('download', filename); // file name
        element.style.display ='none';
        document.body.appendChild(element);
        element.click();
        // commitPost(blob);
    }

    function uploadToGithub() {
        window.open("https://github.com/Operation-P-E-A-C-C-E-Robotics/Operation-P-E-A-C-C-E-Robotics.github.io/upload/main/_robots", '_blank');
    }

</script>
<script>
Array.from(document.querySelectorAll('.mdEdit')).forEach((el) => {

el.setAttribute('title', 'Click to change Markdown content')
el.setAttribute('tabindex', '0')

const displayEl = el.querySelector('div');
const editEl = el.querySelector('input') ? el.querySelector('input') : el.querySelector('textarea');

if (editEl.tagName == 'TEXTAREA') {
    el.style.height = '300px';
}

editEl.addEventListener('change', applyRegex)
applyRegex()

document.addEventListener('keydown', (ev) => {
    if (ev.key == 'Enter' && document.activeElement == el) {
        editEl.focus()
    } else if (ev.key == 'Escape' && document.activeElement == editEl) {
        console.log('faslkdfj');
        document.activeElement.blur()
    }
})

el.addEventListener('click', () => {
    editEl.focus();
})

function applyRegex() {
    let parsed = editEl.value

    if (editEl.tagName == 'TEXTAREA') {
        parsed = parsed.replace(/^###### (.*)/gm, '<h6>$1</h6>')
        parsed = parsed.replace(/^##### (.*)/gm, '<h5>$1</h5>')
        parsed = parsed.replace(/^#### (.*)/gm, '<h4>$1</h4>')
        parsed = parsed.replace(/^### (.*)/gm, '<h3>$1</h3>')
        parsed = parsed.replace(/^## (.*)/gm, '<h2>$1</h2>')
        parsed = parsed.replace(/^# (.*)/gm, '<h1>$1</h1>')

        parsed = parsed.replace(/\!\[(.*?)\]\((.*?)\)/g, '<img src="$2">$1</a>')

        parsed = parsed.replace(/\[(.*?)\]\((.*?)\)/g, '<a href="$2" target="_blank">$1</a>')
    }

    parsed = parsed.replace(/\*\*(.*?)\*\*/g, '<b>$1</b>')
    parsed = parsed.replace(/\*(.*?)\*/g, '<i>$1</i>')
    parsed = parsed.replace(/_(.*?)_/g, '<sub>$1</sub>')
    parsed = parsed.replace(/~(.*?)~/g, '<del>$1</del>')
    parsed = parsed.replace(/\^(.*?)\^/g, '<sup>$1</sup>')
    parsed = parsed.replace(/`(.*?)`/g, '<code>$1</code>')

    displayEl.innerHTML = parsed
}
})
</script>

